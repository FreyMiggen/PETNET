{% extends 'base_test.html' %}
{% load static %}

        
{% block content %}

<div class="columns is-mobile has-text-centered">
  <div class="column is-half is-offset-one-quarter">

    <div class="card">
    <div class="card-content">

    <form method="post" enctype="multipart/form-data" action="" role="form">
      {% csrf_token %}
    <h3 class="title is-3">Edit Profile</h3>

          <!-- <div class="field">
              <label class="label is-medium">Choose your picture</label>
              <div class="file has-name">
                {{ form.picture }}
              </div>
          </div> -->


          <div class="field">
            <label class="label is-medium">Thêm ảnh đại diện:</label>
            <div class="file has-name is-fullwidth">
              <label class="file-label">
                <input class="file-input" type="file" name="{{ form.picture.name }}" id="{{ form.picture.auto_id }}" multiple>
                <span class="file-cta">
                  <span class="file-icon">
                    <i class="fas fa-upload"></i>
                  </span>
                  <span class="file-label">
                    Choose file...
                  </span>
                </span>
                <span class="file-name">
                  No file chosen
                </span>
              </label>
            </div>
            {% if form.picture.errors %}
              <p class="help is-danger">{{ form.picture.errors }}</p>
            {% endif %}
          </div>
          <div id="file-preview" class="columns is-multiline mt-2"></div>


          <div class="field">
              <label class="label is-medium">First name</label>
              <div class="control">
                {{ form.first_name }}
              </div>
          </div>

          <div class="field">
              <label class="label is-medium">Last name</label>
              <div class="control">
                {{ form.last_name }}
              </div>
          </div>

          <div class="field">
              <label class="label is-medium">Location</label>
              <div class="control">
                {{ form.location }}
              </div>
          </div>

          <div class="field">
              <label class="label is-medium">url</label>
              <div class="control">
                {{ form.url }}
              </div>
          </div>

          <div class="field">
              <label class="label is-medium">BIO</label>
              <div class="control">
                {{ form.profile_info }}
              </div>
          </div>

      <div class="row">
        <div class="col s12">
          <span style="color: red; font-weight: bold;">{{ form.errors }}</span>
        </div>
      </div>


      <div class="field">
      <p class="control">
        <button type="submit" value="login" class="button is-success">
          Update
        </button>
      </p>
    </div>

    </form>
  </div>
</div>

  </div>
</div>


<script>
  
  document.addEventListener('DOMContentLoaded', () => {
  const fileInput = document.querySelector('.file-input');
  const fileName = document.querySelector('.file-name');
  const filePreview = document.getElementById('file-preview');

  fileInput.addEventListener('change', (event) => {
    if (event.target.files.length > 0) {
      fileName.textContent = Array.from(event.target.files).map(file => file.name).join(', ');
      
      filePreview.innerHTML = '';
      Array.from(event.target.files).forEach(file => {
        if (file.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = document.createElement('img');
            img.src = e.target.result;
            img.classList.add('column', 'is-3');
            img.style.objectFit = 'cover';
            img.style.height = '100px';
            filePreview.appendChild(img);
          };
          reader.readAsDataURL(file);
        }
      });
    } else {
      fileName.textContent = 'No file chosen';
      filePreview.innerHTML = '';
    }
  });
});

</script>

{% endblock %}